"0",""
"0","library(tidyverse)"
"0",""
"0","# convert date of birth to Date format and extract the birth year"
"0","drivers <- drivers |> "
"0","  mutate(yearOfBirth = year(as.Date(dob, format = ""%Y-%m-%d"")))"
"0",""
"0","# then filter drivers born in 1995 or later"
"0","young_drivers <- drivers |> "
"0","  filter(yearOfBirth >= 1995) |>"
"0","  select(driverId, forename, surname)"
"0",""
"0","# join young_drivers with results to get constructors (teams)"
"0","young_driver_results <- results |>"
"0","  inner_join(young_drivers, by = ""driverId"") |>"
"0","  select(driverId, constructorId, forename, surname)"
"0",""
"0","# join young_driver_results with constructors to get constructor names"
"0","young_driver_results <- young_driver_results |>"
"0","  inner_join(constructors, by = ""constructorId"") |>"
"0","  select(driverId, constructorId, forename, surname, name)|>"
"0","  rename(constructor_name = name)  "
"0",""
"0","# create edges for the network graph (connections between drivers and constructors)"
"0","edges <- young_driver_results |>"
"0","  select(driverId, constructorId) |>"
"0","  rename(from = driverId, to = constructorId)"
"0",""
"0","# Create nodes with driver and constructor names"
"0","driver_nodes <- young_driver_results |>"
"0","  select(driverId, forename, surname) |>"
"0","  distinct() |>"
"0","  mutate(name = paste(forename, surname)) |>"
"0","  select(driverId, name) |>"
"0","  rename(node_id = driverId)"
"0",""
"0","constructor_nodes <- young_driver_results |>"
"0","  select(constructorId, constructor_name) |>"
"0","  distinct() |>"
"0","  rename(node_id = constructorId, name = constructor_name)"
"0",""
"0","# combine all the nodes"
"0","nodes <- bind_rows(driver_nodes, constructor_nodes)"
"0",""
"0","# "
"0","graph <- graph_from_data_frame(edges, vertices = nodes, directed = FALSE)"
"0",""
"0","# plot using ggraph"
"0","ggraph(graph, layout = ""kk"") +"
"0","  geom_edge_link(alpha = 0.5) +"
"0","  geom_node_point(size = 3, aes(color = name)) +"
"0","  geom_node_text(aes(label = name), repel = TRUE, size = 3) +"
"0","  theme_void() +"
"0","  theme(legend.position = ""none"") +"
"0","  labs(title = ""Driver - Team Network Graph"")"
